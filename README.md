# Shadow Art Broker Bot (闇市ブローカーボット)

このボットは「芸術品の密輸」をテーマにした Discord 用経済・トレーディングゲームボットです。
ユーザーは密輸業者となり、AI によって鑑定された画像を売買し、富を築くことを目指します。

## 🚀 実行方法 (How to Run)

仮想環境の使用は必須ではありません。手軽に始めることができます。

### 1. 📂 フォルダの移動

まず、ターミナルで `bot.py` があるフォルダ (`EconomyBot`) に移動します。

```bash
cd EconomyBot
```

### 2. 📦 ライブラリのインストール

必要なライブラリをインストールします。一度やれば OK です。

```bash
pip install -r requirements.txt
```

### 3. ▶️ ボットの起動

以下のコマンドでボットを起動します。

```bash
python bot.py
```

_(Mac/Linux で `python` コマンドが反応しない場合は `python3 bot.py` を試してください)_

---

## ❓ トラブルシューティング (Troubleshooting)

### Q. `ModuleNotFoundError: No module named ...` というエラーが出る

**A. ライブラリがインストールされていません。**
上記の「2. ライブラリのインストール」を実行してください。
もしエラーが解決しない場合は、以下のコマンドで手動インストールを試してください:

```bash
pip install discord.py aiosqlite gradio_client ImageHash Pillow
```

### Q. `[Errno 2] No such file or directory: 'bot.py'`

**A. 実行するフォルダが間違っています。**
現在いるフォルダに `bot.py` がありません。
`ls` (Windows なら `dir`) コマンドでファイル一覧を確認し、`cd EconomyBot` などで正しいフォルダに移動してから実行してください。

### Q. `python` コマンドが見つからない

**A. Python がインストールされていないか、パスが通っていません。**

- Mac/Linux: `python3` と入力してみてください。
- Windows: `py` と入力してみてください。

---

## 📖 機能一覧 (Features)

### 1. 💰 経済システム (Economy)

通貨単位: **Credits (クレジット)**

- `!balance`: 現在の所持金を確認します。
- `!daily`: 1 日 1 回、ログインボーナスを受け取ります。
- `!transfer [ユーザー] [金額]`: 他のユーザーに送金します。

### 2. 🛠️ 初期設定 (Setup)

- `!init_server` (管理者のみ):
  - 必要なチャンネル、カテゴリ、ロール、フォーラムを自動作成します。
  - **重要:** 最初にこのコマンドを実行しないと、他の機能が正しく動作しません。
- `!join`:
  - 闇市に参加登録します。
  - 自分専用のギャラリー(スレッド)が作成され、初期資金(3,000 Credits)が支給されます。

### 3. 🕵️ 密輸システム (Smuggling)

画像を添付してコマンドを実行すると、AI がその価値を鑑定します。

- `!smuggle [画像添付]`:
  - **重複チェック**: 既に誰かが登録した画像(または似た画像)は密輸できません。
  - **AI 鑑定**: AI が「美的スコア」と「タグ(特徴)」を分析します。
  - **価格決定**: スコアと現在のトレンドに基づいて買取価格が決定します。
  - **販売**: 成功すると即座に報酬を受け取り、商品は「闇市ギャラリー」に公開販売されます。

### 4. 📈 トレンドシステム (Daily Trends)

- `!trends`: 今日の流行タグ(姿勢、衣装、身体特徴)を確認します。
  - 毎日朝 6:00 に更新されます。
  - トレンドに合った画像を密輸すると、**高額ボーナス**が発生します。

### 5. 🏪 マーケット & ギャラリー (Market & Gallery)

- **公式ギャラリー**: ボットが買い取った商品が並ぶスレッドです。
- **個人ギャラリー**: `!join` で作成された各プレイヤーの店です。
- **購入機能**: 商品の下にあるボタンで購入できます。
- `!inventory` (または `!inv`): 自分が購入したアイテムを確認します。
- `!resell [ID] [価格]`:
  - 手に入れたアイテムを再販できます。
  - 手数料(20%)が引かれますが、他のプレイヤーに転売して利益を得ることができます。

### 6. 🔧 管理・デバッグ (Admin/Debug)

- `!reset_game`: (管理者専用) 全てのデータを消去し、リセットします。
- `!reset_risk`: 画像の重複チェックデータのみをリセットします。
